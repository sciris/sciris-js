/*!
 * sciris-vue v0.1.0
 * (c) 2018-present Optima Consortium <info@ocds.co>
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e["sciris-vue"]={})}(this,function(exports){"use strict";function sleep(e){return new Promise(t=>setTimeout(t,e))}function getUniqueName(e,t){let r=e,n=0;for(;t.indexOf(r)>-1;)r=e+" ("+(n+=1)+")";return r}function validateYears(e){e.startYear>e.simEnd?e.startYear=e.simEnd:e.startYear<e.simStart&&(e.startYear=e.simStart),e.endYear>e.simEnd?e.endYear=e.simEnd:e.endYear<e.simStart&&(e.endYear=e.simStart)}function projectID(e){if(void 0===e.$store.state.activeProject.project)return"";return e.$store.state.activeProject.project.id}function hasData(e){return void 0!==e.$store.state.activeProject.project&&e.$store.state.activeProject.project.hasData}function hasPrograms(e){return void 0!==e.$store.state.activeProject.project&&e.$store.state.activeProject.project.hasPrograms}function simStart(e){return void 0===e.$store.state.activeProject.project?"":e.$store.state.activeProject.project.sim_start}function simEnd(e){return void 0===e.$store.state.activeProject.project?"":e.$store.state.activeProject.project.sim_end}function simYears(e){if(void 0===e.$store.state.activeProject.project)return[];for(var t=e.$store.state.activeProject.project.sim_start,r=e.$store.state.activeProject.project.sim_end,n=[],o=t;o<=r;o++)n.push(o);return console.log("Sim years: "+n),n}function dataStart(e){return void 0===e.$store.state.activeProject.project?"":e.$store.state.activeProject.project.data_start}function dataEnd(e){return void 0===e.$store.state.activeProject.project?"":(console.log("dataEnd: "+e.$store.state.activeProject.project.data_end),e.$store.state.activeProject.project.data_end)}function dataYears(e){if(void 0===e.$store.state.activeProject.project)return[];{let t=e.$store.state.activeProject.project.data_start,r=e.$store.state.activeProject.project.data_end,n=[];for(let e=t;e<=r;e++)n.push(e);return console.log("data years: "+n),n}}function projectionYears(e){if(void 0===e.$store.state.activeProject.project)return[];{let t=e.$store.state.activeProject.project.data_end,r=e.$store.state.activeProject.project.sim_end,n=[];for(let e=t;e<=r;e++)n.push(e);return console.log("projection years: "+n),n}}function activePops(e){if(void 0===e.$store.state.activeProject.project)return"";{let t=e.$store.state.activeProject.project.pops,r=["All"];for(let e=0;e<t.length;++e)r.push(t[e][1]);return r}}function updateSorting(e,t){console.log("updateSorting() called"),e.sortColumn===t?e.sortReverse=!e.sortReverse:(e.sortColumn=t,e.sortReverse=!1)}var utils={sleep:sleep,getUniqueName:getUniqueName,validateYears:validateYears,projectID:projectID,hasData:hasData,hasPrograms:hasPrograms,simStart:simStart,simEnd:simEnd,simYears:simYears,dataStart:dataStart,dataEnd:dataEnd,dataYears:dataYears,projectionYears:projectionYears,activePops:activePops,updateSorting:updateSorting},bind=function(e,t){return function(){for(var r=new Array(arguments.length),n=0;n<r.length;n++)r[n]=arguments[n];return e.apply(t,r)}},isBuffer_1=function(e){return null!=e&&(isBuffer(e)||isSlowBuffer(e)||!!e._isBuffer)};function isBuffer(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}function isSlowBuffer(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&isBuffer(e.slice(0,0))}var toString=Object.prototype.toString;function isArray(e){return"[object Array]"===toString.call(e)}function isArrayBuffer(e){return"[object ArrayBuffer]"===toString.call(e)}function isFormData(e){return"undefined"!=typeof FormData&&e instanceof FormData}function isArrayBufferView(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer}function isString(e){return"string"==typeof e}function isNumber(e){return"number"==typeof e}function isUndefined(e){return void 0===e}function isObject(e){return null!==e&&"object"==typeof e}function isDate(e){return"[object Date]"===toString.call(e)}function isFile(e){return"[object File]"===toString.call(e)}function isBlob(e){return"[object Blob]"===toString.call(e)}function isFunction(e){return"[object Function]"===toString.call(e)}function isStream(e){return isObject(e)&&isFunction(e.pipe)}function isURLSearchParams(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams}function trim(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")}function isStandardBrowserEnv(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product)&&("undefined"!=typeof window&&"undefined"!=typeof document)}function forEach(e,t){if(null!==e&&void 0!==e)if("object"!=typeof e&&(e=[e]),isArray(e))for(var r=0,n=e.length;r<n;r++)t.call(null,e[r],r,e);else for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.call(null,e[o],o,e)}function merge(){var e={};function t(t,r){"object"==typeof e[r]&&"object"==typeof t?e[r]=merge(e[r],t):e[r]=t}for(var r=0,n=arguments.length;r<n;r++)forEach(arguments[r],t);return e}function extend(e,t,r){return forEach(t,function(t,n){e[n]=r&&"function"==typeof t?bind(t,r):t}),e}var utils$1={isArray:isArray,isArrayBuffer:isArrayBuffer,isBuffer:isBuffer_1,isFormData:isFormData,isArrayBufferView:isArrayBufferView,isString:isString,isNumber:isNumber,isObject:isObject,isUndefined:isUndefined,isDate:isDate,isFile:isFile,isBlob:isBlob,isFunction:isFunction,isStream:isStream,isURLSearchParams:isURLSearchParams,isStandardBrowserEnv:isStandardBrowserEnv,forEach:forEach,merge:merge,extend:extend,trim:trim},normalizeHeaderName=function(e,t){utils$1.forEach(e,function(r,n){n!==t&&n.toUpperCase()===t.toUpperCase()&&(e[t]=r,delete e[n])})},enhanceError=function(e,t,r,n,o){return e.config=t,r&&(e.code=r),e.request=n,e.response=o,e},createError=function(e,t,r,n,o){var s=new Error(e);return enhanceError(s,t,r,n,o)},settle=function(e,t,r){var n=r.config.validateStatus;r.status&&n&&!n(r.status)?t(createError("Request failed with status code "+r.status,r.config,null,r.request,r)):e(r)};function encode(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var buildURL=function(e,t,r){if(!t)return e;var n;if(r)n=r(t);else if(utils$1.isURLSearchParams(t))n=t.toString();else{var o=[];utils$1.forEach(t,function(e,t){null!==e&&void 0!==e&&(utils$1.isArray(e)?t+="[]":e=[e],utils$1.forEach(e,function(e){utils$1.isDate(e)?e=e.toISOString():utils$1.isObject(e)&&(e=JSON.stringify(e)),o.push(encode(t)+"="+encode(e))}))}),n=o.join("&")}return n&&(e+=(-1===e.indexOf("?")?"?":"&")+n),e},ignoreDuplicateOf=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"],parseHeaders=function(e){var t,r,n,o={};return e?(utils$1.forEach(e.split("\n"),function(e){if(n=e.indexOf(":"),t=utils$1.trim(e.substr(0,n)).toLowerCase(),r=utils$1.trim(e.substr(n+1)),t){if(o[t]&&ignoreDuplicateOf.indexOf(t)>=0)return;o[t]="set-cookie"===t?(o[t]?o[t]:[]).concat([r]):o[t]?o[t]+", "+r:r}}),o):o},isURLSameOrigin=utils$1.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),r=document.createElement("a");function n(e){var n=e;return t&&(r.setAttribute("href",n),n=r.href),r.setAttribute("href",n),{href:r.href,protocol:r.protocol?r.protocol.replace(/:$/,""):"",host:r.host,search:r.search?r.search.replace(/^\?/,""):"",hash:r.hash?r.hash.replace(/^#/,""):"",hostname:r.hostname,port:r.port,pathname:"/"===r.pathname.charAt(0)?r.pathname:"/"+r.pathname}}return e=n(window.location.href),function(t){var r=utils$1.isString(t)?n(t):t;return r.protocol===e.protocol&&r.host===e.host}}():function(){return!0},chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function E(){this.message="String contains an invalid character"}function btoa(e){for(var t,r,n=String(e),o="",s=0,i=chars;n.charAt(0|s)||(i="=",s%1);o+=i.charAt(63&t>>8-s%1*8)){if((r=n.charCodeAt(s+=.75))>255)throw new E;t=t<<8|r}return o}E.prototype=new Error,E.prototype.code=5,E.prototype.name="InvalidCharacterError";var btoa_1=btoa,cookies=utils$1.isStandardBrowserEnv()?{write:function(e,t,r,n,o,s){var i=[];i.push(e+"="+encodeURIComponent(t)),utils$1.isNumber(r)&&i.push("expires="+new Date(r).toGMTString()),utils$1.isString(n)&&i.push("path="+n),utils$1.isString(o)&&i.push("domain="+o),!0===s&&i.push("secure"),document.cookie=i.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}},btoa$1="undefined"!=typeof window&&window.btoa&&window.btoa.bind(window)||btoa_1,xhr=function(e){return new Promise(function(t,r){var n=e.data,o=e.headers;utils$1.isFormData(n)&&delete o["Content-Type"];var s=new XMLHttpRequest,i="onreadystatechange",a=!1;if("undefined"==typeof window||!window.XDomainRequest||"withCredentials"in s||isURLSameOrigin(e.url)||(s=new window.XDomainRequest,i="onload",a=!0,s.onprogress=function(){},s.ontimeout=function(){}),e.auth){var c=e.auth.username||"",u=e.auth.password||"";o.Authorization="Basic "+btoa$1(c+":"+u)}if(s.open(e.method.toUpperCase(),buildURL(e.url,e.params,e.paramsSerializer),!0),s.timeout=e.timeout,s[i]=function(){if(s&&(4===s.readyState||a)&&(0!==s.status||s.responseURL&&0===s.responseURL.indexOf("file:"))){var n="getAllResponseHeaders"in s?parseHeaders(s.getAllResponseHeaders()):null,o={data:e.responseType&&"text"!==e.responseType?s.response:s.responseText,status:1223===s.status?204:s.status,statusText:1223===s.status?"No Content":s.statusText,headers:n,config:e,request:s};settle(t,r,o),s=null}},s.onerror=function(){r(createError("Network Error",e,null,s)),s=null},s.ontimeout=function(){r(createError("timeout of "+e.timeout+"ms exceeded",e,"ECONNABORTED",s)),s=null},utils$1.isStandardBrowserEnv()){var l=cookies,f=(e.withCredentials||isURLSameOrigin(e.url))&&e.xsrfCookieName?l.read(e.xsrfCookieName):void 0;f&&(o[e.xsrfHeaderName]=f)}if("setRequestHeader"in s&&utils$1.forEach(o,function(e,t){void 0===n&&"content-type"===t.toLowerCase()?delete o[t]:s.setRequestHeader(t,e)}),e.withCredentials&&(s.withCredentials=!0),e.responseType)try{s.responseType=e.responseType}catch(t){if("json"!==e.responseType)throw t}"function"==typeof e.onDownloadProgress&&s.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&s.upload&&s.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then(function(e){s&&(s.abort(),r(e),s=null)}),void 0===n&&(n=null),s.send(n)})},DEFAULT_CONTENT_TYPE={"Content-Type":"application/x-www-form-urlencoded"};function setContentTypeIfUnset(e,t){!utils$1.isUndefined(e)&&utils$1.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}function getDefaultAdapter(){var e;return"undefined"!=typeof XMLHttpRequest?e=xhr:"undefined"!=typeof process&&(e=xhr),e}var defaults={adapter:getDefaultAdapter(),transformRequest:[function(e,t){return normalizeHeaderName(t,"Content-Type"),utils$1.isFormData(e)||utils$1.isArrayBuffer(e)||utils$1.isBuffer(e)||utils$1.isStream(e)||utils$1.isFile(e)||utils$1.isBlob(e)?e:utils$1.isArrayBufferView(e)?e.buffer:utils$1.isURLSearchParams(e)?(setContentTypeIfUnset(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):utils$1.isObject(e)?(setContentTypeIfUnset(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(e){}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};utils$1.forEach(["delete","get","head"],function(e){defaults.headers[e]={}}),utils$1.forEach(["post","put","patch"],function(e){defaults.headers[e]=utils$1.merge(DEFAULT_CONTENT_TYPE)});var defaults_1=defaults;function InterceptorManager(){this.handlers=[]}InterceptorManager.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},InterceptorManager.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},InterceptorManager.prototype.forEach=function(e){utils$1.forEach(this.handlers,function(t){null!==t&&e(t)})};var InterceptorManager_1=InterceptorManager,transformData=function(e,t,r){return utils$1.forEach(r,function(r){e=r(e,t)}),e},isCancel=function(e){return!(!e||!e.__CANCEL__)},isAbsoluteURL=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)},combineURLs=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e};function throwIfCancellationRequested(e){e.cancelToken&&e.cancelToken.throwIfRequested()}var dispatchRequest=function(e){return throwIfCancellationRequested(e),e.baseURL&&!isAbsoluteURL(e.url)&&(e.url=combineURLs(e.baseURL,e.url)),e.headers=e.headers||{},e.data=transformData(e.data,e.headers,e.transformRequest),e.headers=utils$1.merge(e.headers.common||{},e.headers[e.method]||{},e.headers||{}),utils$1.forEach(["delete","get","head","post","put","patch","common"],function(t){delete e.headers[t]}),(e.adapter||defaults_1.adapter)(e).then(function(t){return throwIfCancellationRequested(e),t.data=transformData(t.data,t.headers,e.transformResponse),t},function(t){return isCancel(t)||(throwIfCancellationRequested(e),t&&t.response&&(t.response.data=transformData(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)})};function Axios(e){this.defaults=e,this.interceptors={request:new InterceptorManager_1,response:new InterceptorManager_1}}Axios.prototype.request=function(e){"string"==typeof e&&(e=utils$1.merge({url:arguments[0]},arguments[1])),(e=utils$1.merge(defaults_1,{method:"get"},this.defaults,e)).method=e.method.toLowerCase();var t=[dispatchRequest,void 0],r=Promise.resolve(e);for(this.interceptors.request.forEach(function(e){t.unshift(e.fulfilled,e.rejected)}),this.interceptors.response.forEach(function(e){t.push(e.fulfilled,e.rejected)});t.length;)r=r.then(t.shift(),t.shift());return r},utils$1.forEach(["delete","get","head","options"],function(e){Axios.prototype[e]=function(t,r){return this.request(utils$1.merge(r||{},{method:e,url:t}))}}),utils$1.forEach(["post","put","patch"],function(e){Axios.prototype[e]=function(t,r,n){return this.request(utils$1.merge(n||{},{method:e,url:t,data:r}))}});var Axios_1=Axios;function Cancel(e){this.message=e}Cancel.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},Cancel.prototype.__CANCEL__=!0;var Cancel_1=Cancel;function CancelToken(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise(function(e){t=e});var r=this;e(function(e){r.reason||(r.reason=new Cancel_1(e),t(r.reason))})}CancelToken.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},CancelToken.source=function(){var e;return{token:new CancelToken(function(t){e=t}),cancel:e}};var CancelToken_1=CancelToken,spread=function(e){return function(t){return e.apply(null,t)}};function createInstance(e){var t=new Axios_1(e),r=bind(Axios_1.prototype.request,t);return utils$1.extend(r,Axios_1.prototype,t),utils$1.extend(r,t),r}var axios=createInstance(defaults_1);axios.Axios=Axios_1,axios.create=function(e){return createInstance(utils$1.merge(defaults_1,e))},axios.Cancel=Cancel_1,axios.CancelToken=CancelToken_1,axios.isCancel=isCancel,axios.all=function(e){return Promise.all(e)},axios.spread=spread;var axios_1=axios,default_1=axios;axios_1.default=default_1;var axios$1=axios_1,commonjsGlobal="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function createCommonjsModule(e,t){return e(t={exports:{}},t.exports),t.exports}var FileSaver_min=createCommonjsModule(function(module,exports){var b;b=function(){function b(e,t){return void 0===t?t={autoBom:!1}:"object"!=typeof t&&(console.warn("Depricated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}function c(e,t,r){var n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){a(n.response,t,r)},n.onerror=function(){console.error("could not download file")},n.send()}function d(e){var t=new XMLHttpRequest;return t.open("HEAD",e,!1),t.send(),200<=t.status&&299>=t.status}function e(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(r){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var f=function(){try{return Function("return this")()||eval("this")}catch(e){return"object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof commonjsGlobal&&commonjsGlobal.global===commonjsGlobal?commonjsGlobal:this}}(),a=f.saveAs||"object"!=typeof window||window!==f?function(){}:"download"in HTMLAnchorElement.prototype?function(t,r,n){var o=f.URL||f.webkitURL,s=document.createElement("a");r=r||t.name||"download",s.download=r,s.rel="noopener","string"==typeof t?(s.href=t,s.origin===location.origin?e(s):d(s.href)?c(t,r,n):e(s,s.target="_blank")):(s.href=o.createObjectURL(t),setTimeout(function(){o.revokeObjectURL(s.href)},4e4),setTimeout(function(){e(s)},0))}:"msSaveOrOpenBlob"in navigator?function(t,r,n){if(r=r||t.name||"download","string"!=typeof t)navigator.msSaveOrOpenBlob(b(t,n),r);else if(d(t))c(t,r,n);else{var o=document.createElement("a");o.href=t,o.target="_blank",setTimeout(function(){e(o)})}}:function(e,t,r,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),"string"==typeof e)return c(e,t,r);var o="application/octet-stream"===e.type,s=/constructor/i.test(f.HTMLElement)||f.safari,i=/CriOS\/[\d]+/.test(navigator.userAgent);if((i||o&&s)&&"object"==typeof FileReader){var a=new FileReader;a.onloadend=function(){var e=a.result;e=i?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=e:location=e,n=null},a.readAsDataURL(e)}else{var u=f.URL||f.webkitURL,l=u.createObjectURL(e);n?n.location=l:location.href=l,n=null,setTimeout(function(){u.revokeObjectURL(l)},4e4)}};f.saveAs=a.saveAs=a,module.exports=a},b()});function consoleLogCommand(e,t,r,n){r||(r=""),n||(n=""),console.log("RPC service call ("+e+"): "+t,r,n)}function readJsonFromBlob(e){return new Promise((t,r)=>{const n=new FileReader;n.addEventListener("loadend",function(){try{var e=JSON.parse(n.result);t(e)}catch(e){r(Error("Failed to convert blob to JSON"))}}),n.readAsText(e)})}var rpcs={rpc:(e,t,r)=>(consoleLogCommand("normal",e,t,r),new Promise((n,o)=>{axios$1.post("/api/rpcs",{funcname:e,args:t,kwargs:r}).then(e=>{void 0!==e.data.error?(console.log("RPC error: "+e.data.error),o(Error(e.data.error))):(console.log("RPC succeeded"),n(e))}).catch(e=>{console.log("RPC error: "+e),e.response?void 0!==e.response.data.exception&&o(Error(e.response.data.exception)):o(e)})})),download:(e,t,r)=>(consoleLogCommand("download",e,t,r),new Promise((n,o)=>{axios$1.post("/api/rpcs",{funcname:e,args:t,kwargs:r},{responseType:"blob"}).then(e=>{readJsonFromBlob(e.data).then(e=>{void 0!==e.error&&o(Error(e.error))}).catch(t=>{var r=new Blob([e.data]),o=e.headers.filename;FileSaver_min(r,o),n(e)})}).catch(e=>{e.response?readJsonFromBlob(e.response.data).then(e=>{void 0!==e.exception&&o(Error(e.exception))}).catch(t=>{o(e)}):o(e)})})),upload:(e,t,r,n)=>(consoleLogCommand("upload",e,t,r),new Promise((o,s)=>{var i=document.createElement("input");i.setAttribute("type","file"),i.setAttribute("accept",n),i.addEventListener("change",n=>{var i=n.target.files||n.dataTransfer.files;i.length||s(Error("No file selected"));const a=new FormData;a.append("uploadfile",i[0]),a.append("funcname",e),a.append("args",JSON.stringify(t)),a.append("kwargs",JSON.stringify(r)),axios$1.post("/api/rpcs",a).then(e=>{void 0!==e.data.error&&s(Error(e.data.error)),o(e)}).catch(e=>{e.response&&void 0!==e.response.data.exception&&s(Error(e.response.data.exception)),s(e)})}),i.click()}))},complete=0;function start(e,t){t||(t="Starting progress");var r=1;complete=0,console.log(t),setTimeout(function t(){complete+=r*(1-complete/100),e.$Progress.set(complete),complete<99&&setTimeout(t,100)},100),e.$spinner.start()}function succeed(e,t){console.log(t),complete=100,e.$spinner.stop(),e.$Progress.finish(),""!==t&&e.$notifications.notify({message:t,icon:"ti-check",type:"success",verticalAlign:"top",horizontalAlign:"right",timeout:2e3})}function fail(e,t,r){console.log(t);var n=r.message.split("Exception details:")[0].replace(/\n/g,"<br>");console.log(r.message),console.log(n),complete=100,e.$spinner.stop(),e.$Progress.fail(),""!==t&&e.$notifications.notify({message:"<b>"+t+"</b><br><br>"+n,icon:"ti-face-sad",type:"warning",verticalAlign:"top",horizontalAlign:"right",timeout:0})}var status={start:start,succeed:succeed,fail:fail};function getPlotOptions(e,t){return new Promise((r,n)=>{console.log("getPlotOptions() called"),status.start(e),rpcs.rpc("get_supported_plots",[t,!0]).then(t=>{e.plotOptions=t.data,status.succeed(e,""),r(t)}).catch(t=>{status.fail(e,"Could not get plot options",t),n(t)})})}function togglePlotControls(e){e.showPlotControls=!e.showPlotControls}function placeholders(e,t){let r=[];t||(t=0);for(let n=t;n<=100;n++)r.push(n),e.showGraphDivs.push(!1),e.showLegendDivs.push(!1);return r}function clearGraphs(e){for(let t=0;t<=100;t++){let r="fig"+t,n=document.getElementById(r);for(;n.firstChild;)n.removeChild(n.firstChild);e.hasGraphs=!1}}function makeGraphs(e,t,r){if(console.log("makeGraphs() called"),r!==e.$route.path)console.log("Not rendering graphs since route changed: "+r+" vs. "+e.$route.path);else{let r=.5;var n=t.graphs;status.start(e),e.hasGraphs=!0,utils.sleep(1e3*r).then(t=>{let r=n.length;console.log("Rendering "+r+" graphs");for(var o=0;o<=r;o++){console.log("Rendering plot "+o);var s="fig"+o,i=document.getElementById(s);if(i)for(;i.firstChild;)i.removeChild(i.firstChild);else console.log("WARNING: figdiv not found: "+s);if(o>=1&&o<r){var a="figcontainer"+o,c=document.getElementById(a);c?c.style.display="flex":console.log("WARNING: figcontainerdiv not found: "+a)}try{mpld3.draw_figure(s,n[o],function(e,t){e.setXTicks(6,function(e){return d3.format(".0f")(e)})})}catch(e){console.log("Could not plot graph: "+e.message)}e.showGraphDivs[o]=!0}status.succeed(e,"Graphs created")})}}function reloadGraphs(e,t,r,n,o,s){console.log("reloadGraphs() called"),utils.validateYears(e),status.start(e),rpcs.rpc("plot_results",[t,r,e.plotOptions],{tool:e.$globaltool,cascade:null,plotyear:e.endYear,pops:e.activePop,calibration:o,plotbudget:s}).then(t=>{e.table=t.data.table,e.makeGraphs(t.data),status.succeed(e,"Data loaded, graphs now rendering...")}).catch(t=>{n?status.fail(e,"Could not make graphs",t):status.succeed(e,"")})}function showBrowserWindowSize(){let e=window.innerWidth,t=window.innerHeight,r=window.outerWidth,n=window.outerHeight;console.log("Browser window size:"),console.log(e,t,r,n)}function scaleElem(e,t){let r=e.getAttribute("width"),n=e.getAttribute("height");e.getAttribute("viewBox")||e.setAttribute("viewBox","0 0 "+r+" "+n),e.setAttribute("width",r*t),e.setAttribute("height",n*t)}function scaleFigs(e,t){e.figscale=e.figscale*t,1===t&&(t=1/e.figscale,e.figscale=1);let r=window.top.document.querySelectorAll("svg.mpld3-figure");for(let e=0;e<r.length;e++)scaleElem(r[e],t)}function addListener(e){document.addEventListener("mousemove",function(t){onMouseUpdate(t,e)},!1)}function onMouseUpdate(e,t){t.mousex=e.pageX,t.mousey=e.pageY}function createDialogs(e){let t=placeholders(e);for(let r in t)newDialog(e,r,"Dialog "+r,"Placeholder content "+r)}function newDialog(e,t,r,n){let o={left:123+Number(t),top:123},s={id:t,name:r,content:n,style:{options:o},options:o};return e.openDialogs.push(s)}function findDialog(e,t,r){console.log("looking");let n=r.findIndex(e=>String(e.id)===String(t));return n>-1?n:null}function maximize(e,t){let r=Number(t),n="DD"+t,o=document.getElementById(n);o?(o.style.left=String(e.mousex-80)+"px",o.style.top=String(e.mousey-300)+"px"):console.log("WARNING: DDdiv not found: "+n),null!==r&&(e.openDialogs[r].options.left=e.mousex-80,e.openDialogs[r].options.top=e.mousey-300),e.showLegendDivs[r]=!0;let s="legendcontainer"+t,i=document.getElementById(s);i?i.style.display="inline-block":console.log("WARNING: containerdiv not found: "+s)}function minimize(e,t){let r=Number(t);e.showLegendDivs[r]=!1;let n="legendcontainer"+t,o=document.getElementById(n);o?o.style.display="none":console.log("WARNING: containerdiv not found: "+n)}var graphs={placeholders:placeholders,clearGraphs:clearGraphs,getPlotOptions:getPlotOptions,togglePlotControls:togglePlotControls,makeGraphs:makeGraphs,reloadGraphs:reloadGraphs,scaleFigs:scaleFigs,showBrowserWindowSize:showBrowserWindowSize,addListener:addListener,onMouseUpdate:onMouseUpdate,createDialogs:createDialogs,newDialog:newDialog,findDialog:findDialog,maximize:maximize,minimize:minimize};function getTaskResultWaiting(e,t,r,n,o){return n||(n=[]),new Promise((s,i)=>{rpcs.rpc("launch_task",[e,r,n,o]).then(r=>{utils.sleep(1e3*t).then(t=>{rpcs.rpc("get_task_result",[e]).then(t=>{rpcs.rpc("delete_task",[e]),s(t)}).catch(e=>{i(e)})})}).catch(e=>{i(e)})})}function getTaskResultPolling(e,t,r,n,o,s){return o||(o=[]),new Promise((i,a)=>{rpcs.rpc("launch_task",[e,n,o,s]).then(n=>{pollStep(e,t,r,0).then(e=>{i(e)}).catch(e=>{a(e)})}).catch(e=>{a(e)})})}function pollStep(e,t,r,n){return new Promise((o,s)=>{n>t&&t>0?s(Error("Task polling timed out")):utils.sleep(1e3*r).then(i=>{rpcs.rpc("check_task",[e]).then(i=>{"completed"==i.data.task.status?rpcs.rpc("get_task_result",[e]).then(t=>{rpcs.rpc("delete_task",[e]),o(t)}).catch(e=>{s(e)}):"error"==i.data.task.status?s(Error(i.data.task.errorText)):pollStep(e,t,r,n+r).then(e=>{o(e)})})})})}var taskService={getTaskResultWaiting:getTaskResultWaiting,getTaskResultPolling:getTaskResultPolling},core=createCommonjsModule(function(e,t){var r;e.exports=(r=r||function(e,t){var r=Object.create||function(){function e(){}return function(t){var r;return e.prototype=t,r=new e,e.prototype=null,r}}(),n={},o=n.lib={},s=o.Base={extend:function(e){var t=r(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},i=o.WordArray=s.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=void 0!=t?t:4*e.length},toString:function(e){return(e||c).stringify(this)},concat:function(e){var t=this.words,r=e.words,n=this.sigBytes,o=e.sigBytes;if(this.clamp(),n%4)for(var s=0;s<o;s++){var i=r[s>>>2]>>>24-s%4*8&255;t[n+s>>>2]|=i<<24-(n+s)%4*8}else for(var s=0;s<o;s+=4)t[n+s>>>2]=r[s>>>2];return this.sigBytes+=o,this},clamp:function(){var t=this.words,r=this.sigBytes;t[r>>>2]&=4294967295<<32-r%4*8,t.length=e.ceil(r/4)},clone:function(){var e=s.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var r,n=[],o=function(t){var t=t,r=987654321,n=4294967295;return function(){var o=((r=36969*(65535&r)+(r>>16)&n)<<16)+(t=18e3*(65535&t)+(t>>16)&n)&n;return o/=4294967296,(o+=.5)*(e.random()>.5?1:-1)}},s=0;s<t;s+=4){var a=o(4294967296*(r||e.random()));r=987654071*a(),n.push(4294967296*a()|0)}return new i.init(n,t)}}),a=n.enc={},c=a.Hex={stringify:function(e){for(var t=e.words,r=e.sigBytes,n=[],o=0;o<r;o++){var s=t[o>>>2]>>>24-o%4*8&255;n.push((s>>>4).toString(16)),n.push((15&s).toString(16))}return n.join("")},parse:function(e){for(var t=e.length,r=[],n=0;n<t;n+=2)r[n>>>3]|=parseInt(e.substr(n,2),16)<<24-n%8*4;return new i.init(r,t/2)}},u=a.Latin1={stringify:function(e){for(var t=e.words,r=e.sigBytes,n=[],o=0;o<r;o++){var s=t[o>>>2]>>>24-o%4*8&255;n.push(String.fromCharCode(s))}return n.join("")},parse:function(e){for(var t=e.length,r=[],n=0;n<t;n++)r[n>>>2]|=(255&e.charCodeAt(n))<<24-n%4*8;return new i.init(r,t)}},l=a.Utf8={stringify:function(e){try{return decodeURIComponent(escape(u.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return u.parse(unescape(encodeURIComponent(e)))}},f=o.BufferedBlockAlgorithm=s.extend({reset:function(){this._data=new i.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=l.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var r=this._data,n=r.words,o=r.sigBytes,s=this.blockSize,a=4*s,c=o/a,u=(c=t?e.ceil(c):e.max((0|c)-this._minBufferSize,0))*s,l=e.min(4*u,o);if(u){for(var f=0;f<u;f+=s)this._doProcessBlock(n,f);var d=n.splice(0,u);r.sigBytes-=l}return new i.init(d,l)},clone:function(){var e=s.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),d=(o.Hasher=f.extend({cfg:s.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){f.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){e&&this._append(e);var t=this._doFinalize();return t},blockSize:16,_createHelper:function(e){return function(t,r){return new e.init(r).finalize(t)}},_createHmacHelper:function(e){return function(t,r){return new d.HMAC.init(e,r).finalize(t)}}}),n.algo={});return n}(Math),r)}),sha256=createCommonjsModule(function(e,t){var r;e.exports=(r=core,function(e){var t=r,n=t.lib,o=n.WordArray,s=n.Hasher,i=t.algo,a=[],c=[];!function(){function t(t){for(var r=e.sqrt(t),n=2;n<=r;n++)if(!(t%n))return!1;return!0}function r(e){return 4294967296*(e-(0|e))|0}for(var n=2,o=0;o<64;)t(n)&&(o<8&&(a[o]=r(e.pow(n,.5))),c[o]=r(e.pow(n,1/3)),o++),n++}();var u=[],l=i.SHA256=s.extend({_doReset:function(){this._hash=new o.init(a.slice(0))},_doProcessBlock:function(e,t){for(var r=this._hash.words,n=r[0],o=r[1],s=r[2],i=r[3],a=r[4],l=r[5],f=r[6],d=r[7],p=0;p<64;p++){if(p<16)u[p]=0|e[t+p];else{var h=u[p-15],g=(h<<25|h>>>7)^(h<<14|h>>>18)^h>>>3,m=u[p-2],v=(m<<15|m>>>17)^(m<<13|m>>>19)^m>>>10;u[p]=g+u[p-7]+v+u[p-16]}var w=n&o^n&s^o&s,y=(n<<30|n>>>2)^(n<<19|n>>>13)^(n<<10|n>>>22),b=d+((a<<26|a>>>6)^(a<<21|a>>>11)^(a<<7|a>>>25))+(a&l^~a&f)+c[p]+u[p];d=f,f=l,l=a,a=i+b|0,i=s,s=o,o=n,n=b+(y+w)|0}r[0]=r[0]+n|0,r[1]=r[1]+o|0,r[2]=r[2]+s|0,r[3]=r[3]+i|0,r[4]=r[4]+a|0,r[5]=r[5]+l|0,r[6]=r[6]+f|0,r[7]=r[7]+d|0},_doFinalize:function(){var t=this._data,r=t.words,n=8*this._nDataBytes,o=8*t.sigBytes;return r[o>>>5]|=128<<24-o%32,r[14+(o+64>>>9<<4)]=e.floor(n/4294967296),r[15+(o+64>>>9<<4)]=n,t.sigBytes=4*r.length,this._process(),this._hash},clone:function(){var e=s.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA256=s._createHelper(l),t.HmacSHA256=s._createHmacHelper(l)}(Math),r.SHA256)}),sha224=createCommonjsModule(function(e,t){var r,n,o,s,i,a;e.exports=(o=(n=r=core).lib.WordArray,s=n.algo,i=s.SHA256,a=s.SHA224=i.extend({_doReset:function(){this._hash=new o.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var e=i._doFinalize.call(this);return e.sigBytes-=4,e}}),n.SHA224=i._createHelper(a),n.HmacSHA224=i._createHmacHelper(a),r.SHA224)});function loginCall(e,t){var r=sha224(t).toString();return rpcs.rpc("user_login",[e,r])}function logoutCall(){return rpcs.rpc("user_logout")}function getCurrentUserInfo(){return rpcs.rpc("get_current_user_info")}function registerUser(e,t,r,n){var o=sha224(t).toString();return rpcs.rpc("user_register",[e,o,r,n])}function changeUserInfo(e,t,r,n){var o=sha224(t).toString();return rpcs.rpc("user_change_info",[e,o,r,n])}function changeUserPassword(e,t){var r=sha224(e).toString(),n=sha224(t).toString();return rpcs.rpc("user_change_password",[r,n])}function adminGetUserInfo(e){return rpcs.rpc("admin_get_user_info",[e])}function deleteUser(e){return rpcs.rpc("admin_delete_user",[e])}function activateUserAccount(e){return rpcs.rpc("admin_activate_account",[e])}function deactivateUserAccount(e){return rpcs.rpc("admin_deactivate_account",[e])}function grantUserAdminRights(e){return rpcs.rpc("admin_grant_admin",[e])}function revokeUserAdminRights(e){return rpcs.rpc("admin_revoke_admin",[e])}function resetUserPassword(e){return rpcs.rpc("admin_reset_password",[e])}function getUserInfo(e){getCurrentUserInfo().then(t=>{e.commit("newUser",t.data.user)}).catch(t=>{e.commit("newUser",{})})}function currentUser(){return store.state.currentUser}function checkLoggedIn(){return void 0!==this.currentUser.displayname}function checkAdminLoggedIn(){if(console.log(this),this.checkLoggedIn())return this.currentUser.admin}function logOut(e){logoutCall().then(t=>{getUserInfo(),store.commit("newActiveProject",{}),e.push("/login")})}var userService={loginCall:loginCall,logoutCall:logoutCall,getCurrentUserInfo:getCurrentUserInfo,registerUser:registerUser,changeUserInfo:changeUserInfo,changeUserPassword:changeUserPassword,adminGetUserInfo:adminGetUserInfo,deleteUser:deleteUser,activateUserAccount:activateUserAccount,deactivateUserAccount:deactivateUserAccount,grantUserAdminRights:grantUserAdminRights,revokeUserAdminRights:revokeUserAdminRights,resetUserPassword:resetUserPassword,getUserInfo:getUserInfo,currentUser:currentUser,checkLoggedIn:checkLoggedIn,checkAdminLoggedIn:checkAdminLoggedIn,logOut:logOut};let components={};function install(e,t){t&&t.components?t.components.forEach(t=>e.component(t.name,components[t.name])):Object.keys(components).forEach(t=>{e.component(t,components[t])})}"undefined"!=typeof window&&window.Vue&&window.Vue.use({install:install});var index={install:install};exports.default=index,exports.graphs=graphs,exports.rpc=rpcs,exports.status=status,exports.user=userService,exports.tasks=taskService,exports.utils=utils,Object.defineProperty(exports,"__esModule",{value:!0})});
//# sourceMappingURL=sciris-vue.min.js.map
